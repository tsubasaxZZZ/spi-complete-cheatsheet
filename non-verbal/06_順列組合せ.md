# 順列・組合せ（場合の数）チートシート

## 基本公式と概念

### 順列（Permutation）
- **定義**: n個から異なるr個を **順序を考慮して** 選ぶ並べ方の総数
- **記号**: $_nP_r$ または P(n,r)
- **公式**: $_nP_r = \frac{n!}{(n-r)!} = n \times (n-1) \times (n-2) \times ... \times (n-r+1)$
- **特殊ケース**: $_nP_n = n!$ （n個すべてを並べる方法の総数）

### 組合せ（Combination）
- **定義**: n個から異なるr個を **順序を考慮せずに** 選ぶ選び方の総数
- **記号**: $_nC_r$ または C(n,r)
- **公式**: $_nC_r = \frac{n!}{r!(n-r)!} = \frac{_nP_r}{r!}$
- **特性**: $_nC_r = _nC_{n-r}$ （r個選ぶことと、n-r個選ぶことは同じ）

### 階乗（Factorial）
- **定義**: n! = n × (n-1) × (n-2) × ... × 2 × 1
- **例**: 5! = 5 × 4 × 3 × 2 × 1 = 120
- **特殊値**: 0! = 1 （定義により）

### 重複を含む場合の公式

#### 重複順列
- **定義**: n種類のものからr個を選ぶ（重複可能）並べ方の総数
- **公式**: $_nΠ_r = n^r$ （nのr乗）

#### 重複組合せ
- **定義**: n種類のものからr個を選ぶ（重複可能）選び方の総数
- **公式**: $_nH_r = _{n+r-1}C_r$

## 頻出問題パターンと解法テクニック

### パターン1: 単純な順列問題
```
問題例: 6人を一列に並べる方法は何通りありますか？
```

**解法**:
- 全員を並べるので $_6P_6 = 6! = 6 \times 5 \times 4 \times 3 \times 2 \times 1 = 720$通り

### パターン2: 単純な組合せ問題
```
問題例: 10人の中から委員会の3人を選ぶ方法は何通りありますか？
```

**解法**:
- 順序を考慮しない選び方なので $_10C_3 = \frac{10!}{3!7!} = \frac{10 \times 9 \times 8}{3 \times 2 \times 1} = 120$通り

### パターン3: 条件付き順列問題
```
問題例: AとBは必ず隣り合うという条件のもと、5人を一列に並べる方法は何通りありますか？
```

**解法**:
1. AとBをひとかたまりと考えると、実質4つの要素（AとBのペア, C, D, E）を並べる問題になる
2. 4つの要素の順列: $_4P_4 = 4! = 24$通り
3. AとBの内部の順列: $_2P_2 = 2! = 2$通り
4. 合計: $24 \times 2 = 48$通り

### パターン4: 円順列（円状に並べる）
```
問題例: 6人が円卓に座る方法は何通りありますか？
```

**解法**:
- 円順列では開始位置に意味がないため、通常の順列を人数で割る
- 計算: $(6-1)! = 5! = 120$通り

### パターン5: 同種のものを含む順列
```
問題例: 「MISSISSIPPI」という単語の文字を並べ替えて作れる異なる単語は何通りありますか？
```

**解法**:
1. 全体の文字数: 11文字
2. 重複している文字: M(1個), I(4個), S(4個), P(2個)
3. 計算: $\frac{11!}{1!4!4!2!} = \frac{39,916,800}{1 \times 24 \times 24 \times 2} = 34,650$通り

## 応用問題と解法のコツ

### 仕切り問題（分配問題）
```
問題例: 8個のボールを3つの箱に分ける方法は何通りありますか？
       （箱の区別あり、ボールの区別なし、箱は空でもよい）
```

**解法**:
- 重複組合せの問題: $_3H_8 = _{3+8-1}C_8 = _{10}C_8 = _{10}C_2 = 45$通り

### 少なくとも問題
```
問題例: 6枚のカードから3枚選ぶとき、少なくとも1枚のハートを含む選び方は何通りですか？
       （カードは3枚のハートと3枚のダイヤからなる）
```

**解法**:
1. 全体の選び方: $_6C_3 = 20$通り
2. ハートを1枚も含まない選び方: $_3C_3 = 1$通り（ダイヤ3枚を選ぶ）
3. 少なくとも1枚のハートを含む選び方: $20 - 1 = 19$通り

### 条件付き組合せ問題
```
問題例: 男性5人、女性3人の中から4人の委員を選ぶとき、女性が少なくとも1人含まれる選び方は何通りですか？
```

**解法**:
1. 全体の選び方: $_8C_4 = 70$通り
2. 女性が1人も含まれない選び方: $_5C_4 = 5$通り（男性だけ4人選ぶ）
3. 女性が少なくとも1人含まれる選び方: $70 - 5 = 65$通り

## 頻出の組合せ数値

### よく使う階乗
- 3! = 6
- 4! = 24
- 5! = 120
- 6! = 720
- 7! = 5,040
- 8! = 40,320
- 9! = 362,880
- 10! = 3,628,800

### よく使う組合せ
- $_5C_2 = 10$
- $_5C_3 = 10$
- $_6C_2 = 15$
- $_6C_3 = 20$
- $_7C_2 = 21$
- $_7C_3 = 35$
- $_8C_2 = 28$
- $_8C_3 = 56$
- $_8C_4 = 70$
- $_9C_2 = 36$
- $_9C_3 = 84$
- $_9C_4 = 126$
- $_10C_2 = 45$
- $_10C_3 = 120$
- $_10C_4 = 210$
- $_10C_5 = 252$

## 計算のショートカットと注意点

### 計算を簡略化するテクニック
1. **nCrの対称性を利用する**: $_nC_r = _nC_{n-r}$
   例: $_10C_8 = _{10}C_2 = 45$

2. **階乗の計算を省略する**: 
   例: $_8C_3 = \frac{8 \times 7 \times 6}{3 \times 2 \times 1} = 56$

3. **パスカルの三角形を利用する**:
   ```
       1
      1 1
     1 2 1
    1 3 3 1
   1 4 6 4 1
   ...
   ```
   n段目のr番目の数値が $_nC_r$ となる
   
4. **組合せの漸化式を使う**: $_nC_r = _{n-1}C_{r-1} + _{n-1}C_r$

### よくある間違いと対策

1. **順列と組合せの混同**: 問題が順序を考慮するかどうかを確認
   → 「並べる」→順列、「選ぶ」→組合せという言葉の使い分けに注目

2. **重複の取り扱いミス**: 重複を許すかどうか、区別するかどうかを確認
   → 問題文の「異なる」「同じ種類の」などのキーワードに注目

3. **円順列の計算ミス**: 一般の順列と円順列の違いを理解
   → 円順列では (n-1)! 通りになる

4. **「少なくとも」の計算ミス**: 全体から「含まない」場合を引く
   → 直接計算するより、余事象（補集合）を使うと簡単な場合が多い

5. **階乗計算の桁あふれ**: 大きな数の階乗計算
   → 途中で約分できないか確認し、分数の形で計算を進める

## 実践的なアプローチ方法

1. **問題を正確に把握する**: 順列か組合せか、重複を許すか、条件は何か
2. **図や表を使って整理する**: 複雑な問題は場合分けして図示する
3. **樹形図を活用する**: 選択肢が少ない場合は全パターンを書き出す
4. **簡潔な式で表す**: 複雑な計算は約分して簡略化する